(("undefined"!=typeof self?self:this).webpackJsonp_pro_gallery_santa_wrapper=("undefined"!=typeof self?self:this).webpackJsonp_pro_gallery_santa_wrapper||[]).push([[17],{325:function(t,i,e){"use strict";e.r(i);var n=e(37),s=e(5),o=e(6),a=e(71);function l(t,i){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);i&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),e.push.apply(e,n)}return e}function r(t){for(var i=1;i<arguments.length;i++){var e=null!=arguments[i]?arguments[i]:{};i%2?l(Object(e),!0).forEach((function(i){h(t,i,e[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):l(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}))}return t}function h(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}var d={SCROLL:"SCROLL",CLICKED:"CLICKED",HOVERED:"HOVERED",ENDED:"ENDED",INIT_SCROLL:"INIT_SCROLL"},c=function(){function t(t){var i=this;this.scrollBase=0,this.videoItems=[],this.currentPlayingIdx=-1,this.nextInLineIdx=-1,this.lastItemCount=0,this.playing=!1,this.updateGalleryStructure=this.updateGalleryStructure.bind(this),this.initializePlayState=this.initializePlayState.bind(this),this.onScroll=this.onScroll.bind(this),this.handleEvent=this.handleEvent.bind(this),this.play=this.play.bind(this),this.stop=this.stop.bind(this),this.isVisible=this.isVisible.bind(this),this.top=0,this.left=0,this.videoPlay=void 0,this.itemClick=void 0,this.setPlayingVideos=t.setPlayingVideos,this.trigger=Object.assign.apply(Object,[{}].concat(Object.keys(d).map((function(t){var e;return(e={})[t]=function(e){return i.handleEvent({eventName:t,eventData:e})},e}))))}var i=t.prototype;return i.updateGalleryStructure=function(t){var i=this,e=t.galleryStructure,s=t.scrollBase,o=t.videoPlay,a=t.itemClick,l=t.oneRow;this.galleryWidth=n.a.getGalleryDimensions().galleryWidth,this.scrollBase=s,this.videoPlay=o,this.itemClick=a,this.oneRow=l;var h=this.lastItemCount,d=e.galleryItems.length;(this.lastItemCount=d,h!==d)&&e.galleryItems.slice(h,d).forEach((function(t){("video"===t.type||"image"===t.type&&(t.id.includes("_placeholder")||t.isVideoPlaceholder))&&i.videoItems.push(r(r({},t),{},{videoPlayRating:t.idx}))}))},i.handleEvent=function(t){var i=t.eventName,e=t.eventData;switch(i){case d.SCROLL:this.onScroll(e);break;case s.a.events.ITEM_ACTION_TRIGGERED:this.itemClicked(e.idx);break;case s.a.events.HOVER_SET:this.itemHovered(e);break;case s.a.events.VIDEO_ENDED:this.videoEnded(e.idx);break;case d.INIT_SCROLL:this.ScrollializePlayState()}},i.itemHovered=function(t){"hover"===this.videoPlay&&this.IdxExistsInVideoItems(t)&&this.play(t,-1)},i.itemClicked=function(t){"onClick"===this.videoPlay&&this.IdxExistsInVideoItems(t)&&(this.currentPlayingIdx===t?this.stop():this.play(t,-1))},i.onScroll=function(t){var i=this,e=t.top,n=t.left;this.top=e||this.top,this.left=n||this.left,-1===this.currentPlayingIdx||this.isCurrentVideoStillVisible({top:this.top,left:this.left})||this.stop(this.videoItems.findIndex((function(t){return t.idx===i.currentPlayingIdx}))),this.shouldAutoPlay()&&this.playNextVideoByRating({top:this.top,left:this.left})},i.videoEnded=function(t){var i=this.videoItems.findIndex((function(i){return i.idx===t}));this.stop(i);var e={top:this.top,left:this.left};this.shouldAutoPlay()&&this.playNextVideoByRating(e)},i.initializePlayState=function(){this.shouldAutoPlay()&&this.playNextVideoByRating({top:this.top,left:this.left})},i.playNextVideoByRating=function(t){var i=this,e=t.top,n=t.left,s={idx:-1,rating:1/0},o={idx:-1,rating:1/0};this.videoItems.some((function(t){return i.isVisible(t,{top:e,left:n})?(t.videoPlayRating<=o.rating?(s.idx=o.idx,s.rating=o.rating,o.idx=t.idx,o.rating=t.videoPlayRating):t.videoPlayRating<=s.rating&&(s.idx=t.idx,s.rating=t.videoPlayRating),!1):o.idx>=0})),this.play(o.idx,s.idx)},i.calculateCurrentItemPlacement=function(){var t=this;return this.videoItems.findIndex((function(i){return i.idx===t.currentPlayingIdx}))},i.play=function(t,i){this.setNextInLineIdx(i),this.setPlayingIdx(t),this.playing=!0},i.stop=function(t){t>=0&&(this.videoItems[t].videoPlayRating+=1337),this.setPlayingIdx(-1),this.playing=!1},i.onPlayingIdxChange=function(){this.setPlayingVideos(this.currentPlayingIdx,this.nextInLineIdx)},i.setPlayingIdx=function(t){this.currentPlayingIdx!==t&&(this.currentPlayingIdx=t,this.onPlayingIdxChange())},i.setNextInLineIdx=function(t){this.nextInLineIdx!==t&&(this.nextInLineIdx=t,this.onPlayingIdxChange())},i.isCurrentVideoStillVisible=function(t){var i=t.top,e=t.left,n=this.calculateCurrentItemPlacement();return this.isVisible(this.videoItems[n],{top:i,left:e})},i.isVisible=function(t,i){var e,n=i.top,s=i.left,l={offsetTop:this.scrollBase||0,scrollY:n,scrollLeft:s},r=(t.offset.top-t.offset.bottom)/2,h=(t.offset.left-t.offset.right)/2,d=Object(a.b)({target:l,scrollBase:this.scrollBase,top:t.offset.top,bottom:t.offset.top+t.style.height,screenHeight:o.a&&o.a.innerHeight,padding:r});return e=!this.oneRow||Object(a.a)({target:l,left:t.offset.left,right:t.offset.left+t.style.width,screenWidth:this.galleryWidth||o.a&&o.a.innerWidth,padding:h}),d&&e},i.shouldAutoPlay=function(){return"auto"===this.videoPlay},i.IdxExistsInVideoItems=function(t){return this.videoItems.some((function(i){return i.idx===t}))},t}();i.default=c}}]);
//# sourceMappingURL=videoScrollHelper.chunk.min.js.map